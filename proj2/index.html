<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Diffusion Models – Visualizations</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../styles.css" />
</head>

<body class="top-title">

  <canvas id="sky" aria-hidden="true"></canvas>
  <header class="site-header">
    <div class="content">
      <nav class="top-nav" aria-label="Project navigation">
        <a href="../../index.html" class="nav-logo">
          Home
        </a>
      </nav>
    </div>
  </header>

  <div class="content big-title">
    <h1 class="title">Filters and Frequencies</h1>
  </div>

  <!-- ============================================ 1.1 Convolutions from Scratch ===================================== -->
  <section class="content gold-glass iteration-belt" id="part1.1">
    <h2 class="section-heading">1.1 Convolutions from Scratch</h2>

    <div class="iteration-belt__intro">
      <p>
        A discrete convolution applies a fixed kernel to every pixel location and replaces the
        pixel by a weighted sum of its neighborhood, using zero-padding so that the output has the
        same extent as the input. Because the same weights are used everywhere, the operation is
        linear and shift-invariant; any change in behavior must come from the kernel rather than
        from the particular implementation.
      </p>
      <p>
        The same operator is applied in three ways: a direct four-loop version that mirrors the
        mathematical definition, a two-loop NumPy version that vectorizes the inner products over
        image patches, and SciPy’s optimized <code>convolve2d</code>. Each is applied to a self-portrait
        using an identical 9×9 box kernel, and the same three implementations are then applied to the
        finite-difference filters <code>Dx</code> and <code>Dy</code>.
      </p>
    </div>

    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">9×9 box filter and finite differences on self-portrait</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>

    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <!-- Box filter -->
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/conv_four_loops.png"
            alt="Self-portrait blurred with four-loop convolution">
          <figcaption class="iteration-belt__caption">
            9×9 box filter — four-loop convolution (direct discrete implementation)
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/conv_two_loops.png"
            alt="Self-portrait blurred with two-loop convolution">
          <figcaption class="iteration-belt__caption">
            9×9 box filter — two-loop convolution (vectorized inner sum)
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/conv_scipy.png"
            alt="Self-portrait blurred with SciPy convolve2d">
          <figcaption class="iteration-belt__caption">
            9×9 box filter — SciPy <code>convolve2d</code> reference implementation
          </figcaption>
        </figure>

        <!-- Finite differences (Dx, Dy) -->
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/Dx_four_loops.png"
            alt="Dx response on self-portrait using four-loop convolution">
          <figcaption class="iteration-belt__caption">
            <code>Dx</code> response — four-loop implementation
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/Dy_four_loops.png"
            alt="Dy response on self-portrait using four-loop convolution">
          <figcaption class="iteration-belt__caption">
            <code>Dy</code> response — four-loop implementation
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/Dx_two_loops.png"
            alt="Dx response on self-portrait using two-loop convolution">
          <figcaption class="iteration-belt__caption">
            <code>Dx</code> response — two-loop implementation
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/Dy_two_loops.png"
            alt="Dy response on self-portrait using two-loop convolution">
          <figcaption class="iteration-belt__caption">
            <code>Dy</code> response — two-loop implementation
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/Dx_scipy.png"
            alt="Dx response on self-portrait using SciPy convolve2d">
          <figcaption class="iteration-belt__caption">
            <code>Dx</code> response — SciPy <code>convolve2d</code>
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/1_convolutions/Dy_scipy.png"
            alt="Dy response on self-portrait using SciPy convolve2d">
          <figcaption class="iteration-belt__caption">
            <code>Dy</code> response — SciPy <code>convolve2d</code>
          </figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        Benchmarking the 9×9 box filter on this image yields average runtimes of
        14.990 s (four loops), 2.670 s (two loops), and 0.114 s (SciPy), implying roughly
        5.6× speedup from vectorizing the inner sum and roughly 132× speedup from the SciPy
        implementation over the naive baseline. The timing values in <code>conv_timings.csv</code>
        are in seconds (as returned by the benchmark), while the command-line printout is in
        milliseconds because it multiplies by 1000.
      </p>
      <p>
        The box-filter outputs are visually indistinguishable across implementations, indicating
        that the three methods realize the same linear operator with different constant factors.
        The <code>Dx</code>/<code>Dy</code> visualizations likewise match after normalization; their
        embossed appearance reflects that derivative responses are signed, so display normalization
        maps near-zero regions toward mid-gray and assigns opposite contrast to opposite edge directions.
      </p>
    </div>

  </section>


  <div class="code-snippets">
    <h3 class="code-snippets__title">Convolution implementations (Python)</h3>

    <!-- 1. pad_zero -->
    <details class="code-snippet">
      <summary>pad_zero</summary>
      <div class="code-snippet__body">
        <pre class="code-block"><code class="language-python">import numpy as np

def pad_zero(img: np.ndarray, pad_h: int, pad_w: int) -&gt; np.ndarray:
    """Zero-pad a 2D image by (pad_h, pad_w) on all sides."""
    assert img.ndim == 2
    H, W = img.shape
    out = np.zeros((H + 2 * pad_h, W + 2 * pad_w), dtype=img.dtype)
    out[pad_h: pad_h + H, pad_w: pad_w + W] = img
    return out</code></pre>
      </div>
    </details>

    <!-- 2. conv2d_four_loops -->
    <details class="code-snippet">
      <summary>conv2d_four_loops</summary>
      <div class="code-snippet__body">
        <pre class="code-block"><code class="language-python">def conv2d_four_loops(img: np.ndarray, kernel: np.ndarray) -&gt; np.ndarray:
    """
    Naive 2D convolution using 4 nested loops and zero padding.

    img:    2D grayscale image
    kernel: 2D filter kernel
    """
    assert img.ndim == 2
    # flip kernel for convolution
    k = np.flipud(np.fliplr(kernel))
    kh, kw = k.shape
    ph, pw = kh // 2, kw // 2

    padded = pad_zero(img, ph, pw)
    H, W = img.shape
    out = np.zeros_like(img, dtype=np.float32)

    for y in range(H):
        for x in range(W):
            acc = 0.0
            for j in range(kh):
                for i in range(kw):
                    acc += padded[y + j, x + i] * k[j, i]
            out[y, x] = acc
    return out</code></pre>
      </div>
    </details>

    <!-- 3. conv2d_two_loops -->
    <details class="code-snippet">
      <summary>conv2d_two_loops</summary>
      <div class="code-snippet__body">
        <pre class="code-block"><code class="language-python">def conv2d_two_loops(img: np.ndarray, kernel: np.ndarray) -&gt; np.ndarray:
    """
    More efficient convolution: 2 loops over pixels, inner sum done by NumPy.
    """
    assert img.ndim == 2
    k = np.flipud(np.fliplr(kernel))
    kh, kw = k.shape
    ph, pw = kh // 2, kw // 2

    padded = pad_zero(img, ph, pw)
    H, W = img.shape
    out = np.zeros_like(img, dtype=np.float32)

    for y in range(H):
        # slice the relevant "row band" once per y
        row = padded[y: y + kh, :]
        for x in range(W):
            patch = row[:, x: x + kw]
            out[y, x] = float(np.sum(patch * k))
    return out</code></pre>
      </div>
    </details>
  </div>



  <!-- ============================================ 1.2 Finite Difference Operator ==================================== -->
  <section class="content gold-glass iteration-belt" id="part1-2">
    <h2 class="section-heading">1.2 Finite Difference Operator</h2>

    <div class="iteration-belt__intro">
      <p>
        Simple finite-difference kernels approximate the partial derivatives of an image. A
        horizontal difference filter estimates changes in intensity along the x-direction, and a
        vertical difference filter does the same along y. Applied to the cameraman image, these
        operators produce derivative images that respond where the scene contains strong
        horizontal or vertical contrast and remain near zero where intensity varies slowly.
      </p>
    </div>

    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Cameraman gradients, magnitudes, and edges</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>

    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/2_finitie_difference_operator/cameraman.png"
            alt="Original cameraman image">
          <figcaption class="iteration-belt__caption">
            Original cameraman image (grayscale reference for all derivative visualizations).
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/2_finitie_difference_operator/Ix.png"
            alt="Horizontal derivative of the cameraman image">
          <figcaption class="iteration-belt__caption">
            Horizontal derivative: vertical structures such as the tripod legs and building edges
            appear as bright responses where intensity changes strongly left-to-right.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/2_finitie_difference_operator/Iy.png"
            alt="Vertical derivative of the cameraman image">
          <figcaption class="iteration-belt__caption">
            Vertical derivative: horizontal structures such as the horizon and rooftop lines
            dominate the response, while sky and grass remain near zero.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/2_finitie_difference_operator/grad_mag.png"
            alt="Gradient magnitude of the cameraman image">
          <figcaption class="iteration-belt__caption">
            Gradient magnitude: combines horizontal and vertical changes into a single measure of
            edge strength, concentrating high values along object boundaries.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/2_finitie_difference_operator/edges.png"
            alt="Binary edge map from thresholded gradient magnitude">
          <figcaption class="iteration-belt__caption">
            Binary edge map: thresholded gradient magnitude retains the main contours of the
            cameraman, tripod, and skyline while suppressing small noisy responses.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/2_finitie_difference_operator/orientation_fast.png"
            alt="Gradient orientation visualization using fast approximation">
          <figcaption class="iteration-belt__caption">
            Orientation visualization (fast approximation): edge direction is encoded as hue, with
            saturation driven by gradient strength, revealing how directions vary smoothly along
            curved contours.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/2_finitie_difference_operator/orientation_atan.png"
            alt="Gradient orientation visualization using arctangent reference">
          <figcaption class="iteration-belt__caption">
            Orientation visualization (arctangent reference): produces almost identical color
            patterns, confirming that the approximate method recovers the same underlying
            orientation field at lower computational cost.
          </figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        Taken together, the directional derivatives, gradient magnitude, thresholded edge map, and
        orientation visualizations provide a first-order geometric description of the image. The
        derivatives separate vertical from horizontal structure, the gradient magnitude identifies
        locations of maximal change, and the binary map selects a subset of those locations as
        edges. The orientation fields attach a direction to each edge pixel, information required
        for later constructions such as corners or oriented descriptors. The close match between
        the approximate and arctangent-based orientation images shows that a cheaper numerical
        scheme can recover essentially the same orientation field for subsequent processing.
      </p>
    </div>
  </section>




  <!-- =============================== 1.3 Derivative of Gaussian Filter ================================= -->
  <section class="content gold-glass iteration-belt" id="part1-3">
    <h2 class="section-heading">1.3 Derivative of Gaussian Filter</h2>

    <div class="iteration-belt__intro">
      <p>
        We now explore two strategies for computing smoothed image gradients: first blurring
        the image with a Gaussian filter and then applying finite-difference kernels, versus
        convolving once with derivative-of-Gaussian (DoG) kernels. Since convolution is linear and
        shift-invariant, differentiating the Gaussian and then convolving the result with the image
        should be equivalent, up to numerical and boundary effects, to convolving with the Gaussian
        followed by discrete differentiation.
      </p>
      <p>
        Horizontal and vertical derivative-of-Gaussian kernels are constructed and applied to the
        cameraman image. The resulting directional derivatives and gradient magnitudes are
        juxtaposed with those obtained from the “smooth then difference” pipeline. The comparison
        tests whether the one-step DoG approach reproduces the same sharpened edges and reduced
        noise as the two-stage method that explicitly separates smoothing and differentiation.
      </p>
    </div>

    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Gaussian smoothing vs. derivative-of-Gaussian</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>

    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/3_derivative_of_gaussian_filter/DoGx_kernel.png"
            alt="Horizontal derivative-of-Gaussian kernel">
          <figcaption class="iteration-belt__caption">
            Horizontal DoG kernel: a smoothed, antisymmetric pattern that responds to vertical
            edges while attenuating high-frequency noise.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/3_derivative_of_gaussian_filter/DoGy_kernel.png"
            alt="Vertical derivative-of-Gaussian kernel">
          <figcaption class="iteration-belt__caption">
            Vertical DoG kernel: rotated counterpart used to detect horizontal edges with the same
            built-in smoothing.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/3_derivative_of_gaussian_filter/Ix_smooth_then_diff.png"
            alt="Horizontal derivative after Gaussian smoothing then finite difference">
          <figcaption class="iteration-belt__caption">
            Horizontal gradient from “smooth then difference”: vertical contours of the tripod,
            coat, and buildings remain sharp, but background noise is strongly reduced.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/3_derivative_of_gaussian_filter/Iy_smooth_then_diff.png"
            alt="Vertical derivative after Gaussian smoothing then finite difference">
          <figcaption class="iteration-belt__caption">
            Vertical gradient from “smooth then difference”: horizontal structures such as the
            horizon and rooftops dominate the response with fewer speckles in the sky and grass.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/3_derivative_of_gaussian_filter/grad_smooth_then_diff.png"
            alt="Gradient magnitude after Gaussian smoothing then finite difference">
          <figcaption class="iteration-belt__caption">
            Gradient magnitude for “smooth then difference”: a clean edge map where strong
            contours are preserved and fine-grained noise has been suppressed by the initial blur.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/3_derivative_of_gaussian_filter/Ix_DoG.png"
            alt="Horizontal derivative from derivative-of-Gaussian convolution">
          <figcaption class="iteration-belt__caption">
            Horizontal gradient from DoG convolution: closely matches the smooth-then-differentiate
            result, confirming that the DoG kernel embeds both smoothing and differentiation.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/3_derivative_of_gaussian_filter/Iy_DoG.png"
            alt="Vertical derivative from derivative-of-Gaussian convolution">
          <figcaption class="iteration-belt__caption">
            Vertical gradient from DoG convolution: edge strengths and locations align with the
            corresponding smooth-then-difference vertical derivative.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/one/3_derivative_of_gaussian_filter/grad_DoG.png"
            alt="Gradient magnitude from derivative-of-Gaussian convolution">
          <figcaption class="iteration-belt__caption">
            Gradient magnitude from DoG convolution: nearly indistinguishable from the
            smooth-then-difference magnitude, demonstrating the equivalence of the two pipelines in
            both structure and edge strength.
          </figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The side-by-side comparison shows that Gaussian smoothing followed by finite differencing
        and direct convolution with derivative-of-Gaussian kernels produce essentially the same
        gradient fields and edge magnitudes. Residual discrepancies are minor and can be explained
        by numerical precision and padding rather than by any substantive difference in the
        underlying operators. Derivative-of-Gaussian filters therefore provide a compact, one-step
        realization of the “blur then differentiate” pipeline and serve as a convenient and robust
        building block for edge detection and feature extraction.
      </p>
    </div>
  </section>


  <!-- ============================================ 2.1 Image Sharpening (Unsharp Masking) =========================== -->
  <section class="content gold-glass iteration-belt" id="part2-1">
    <h2 class="section-heading">2.1 Image Sharpening with Unsharp Masking</h2>

    <div class="iteration-belt__intro">
      <p>
        This section analyzes unsharp masking as a method for enhancing fine detail in a photograph
        of the Taj Mahal. The procedure forms a smoothed version of the image by convolving with a
        Gaussian blur kernel, subtracts this low-pass version from the original to isolate a
        high-pass component containing edges and textures, and then adds a scaled copy of this
        high-pass signal back to the original. The sharpened image exhibits increased local
        contrast near boundaries while largely preserving the global brightness and coloration of
        the scene.
      </p>
      <p>
        Interpreted in terms of kernels, unsharp masking combines an impulse-like identity kernel
        with a negative Gaussian to create an effective filter with a strong positive center and a
        weaker negative surround. This structure amplifies rapid spatial changes and slightly
        suppresses slowly varying regions. The intermediate visualizations of the blur, the
        extracted high-pass component, the sharpened output, and the equivalent single unsharp
        kernel clarify how the operation redistributes contrast across spatial scales.
      </p>
    </div>

    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Unsharp masking pipeline on the Taj Mahal</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>

    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/unsharp_kernel.png"
            alt="Gaussian blur kernel used for unsharp masking">
          <figcaption class="iteration-belt__caption">
            Gaussian blur kernel: a small, isotropic low-pass filter that produces a softened version
            of the image and suppresses high-frequency noise.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/blurred.png" alt="Blurred Taj Mahal image">
          <figcaption class="iteration-belt__caption">
            Blurred image: large-scale structure of the Taj Mahal is preserved, but fine architectural
            details and textures in the trees and walkway are noticeably washed out.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/highpass.png"
            alt="High-pass component obtained by subtracting blur from the original">
          <figcaption class="iteration-belt__caption">
            High-pass component: subtraction of the blurred image from the original isolates edges and
            fine detail. The building outline, ornamental patterns, and strong intensity transitions
            appear as bright responses on a dark background.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/sharpened.png"
            alt="Sharpened Taj Mahal image after unsharp masking">
          <figcaption class="iteration-belt__caption">
            Sharpened result: adding a scaled high-pass signal back to the original yields a crisper
            image. The dome ridges, facade carvings, and tree silhouettes gain local contrast without
            creating strong halos or amplifying background noise.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/sharpened_kernel.png"
            alt="Effective unsharp masking kernel">
          <figcaption class="iteration-belt__caption">
            Effective unsharp kernel: combining the impulse (identity) with a negative Gaussian blur
            produces a single convolution kernel whose positive center and negative surround implement
            “original plus scaled high-pass” in one step.
          </figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__intro">
      <p>
        The same unsharp masking pipeline is then applied to a scanned vintage family photograph as
        a second example. In this case the blur uses a broader Gaussian with a larger kernel so
        that the high-pass component captures mid-scale structures such as facial features,
        clothing folds, and plant outlines, while averaging over film grain and digitization noise.
        The visualizations again present the blur, the extracted high-frequency content, the
        sharpened image, and the effective kernel.
      </p>
    </div>

    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Unsharp masking on a vintage family scan</h3>
      <!-- <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button> -->
    </div>

    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/grandpa/unsharp_kernel.png"
            alt="Gaussian blur kernel used to smooth the vintage photo">
          <figcaption class="iteration-belt__caption">
            Gaussian blur kernel used to define the low-pass component for the vintage photograph,
            tuned to treat facial features and clothing folds as detail while smoothing over finer
            grain.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/grandpa/gp.jpeg"
            alt="Original vintage family photograph before sharpening">
          <figcaption class="iteration-belt__caption">
            Original scan: a slightly faded, low-contrast family photograph with modest blur and
            visible texture from aging and digitization.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/grandpa/blurred.png"
            alt="Blurred version of the vintage family photograph">
          <figcaption class="iteration-belt__caption">
            Blurred image: large shapes such as the figure and background plants remain, but fine
            details in the face, shirt, and foliage are smoothed away by the Gaussian filter.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/grandpa/highpass.png"
            alt="High-pass component of the vintage family photograph">
          <figcaption class="iteration-belt__caption">
            High-pass component: subtraction of the blur from the original isolates edges and local
            contrast changes, outlining the figure, clothing seams, and wire fence while largely
            suppressing uniform regions.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/grandpa/sharpened.png"
            alt="Sharpened vintage family photograph after unsharp masking">
          <figcaption class="iteration-belt__caption">
            Sharpened result: adding the high-pass signal back restores crispness to facial
            features and surrounding vegetation, making the photograph clearer without introducing
            strong halos or emphasizing noise artifacts.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/1_sharpening/grandpa/sharpened_kernel.png"
            alt="Effective unsharp masking kernel for the vintage family photograph">
          <figcaption class="iteration-belt__caption">
            Effective unsharp kernel: the central impulse and negative Gaussian surround together
            implement the entire “original plus scaled high-pass” operation as a single convolution,
            tuned to the softer focus and lower resolution of the scan.
          </figcaption>
        </figure>
      </div>
    </div>

    <!-- <div class="iteration-belt__outro">
      <p>
        The Taj Mahal and vintage photograph examples together show how unsharp masking parameters
        fix the notion of “detail” that is being enhanced. A narrower blur sharpens fine
        architectural edges in a high-resolution scene, whereas a broader blur applied to the scan
        targets mid-scale structure and prevents film grain from becoming visually dominant. In
        both cases, the method operates by selectively boosting high-frequency content relative to
        a smooth background, producing images that appear more focused without resorting to a
        simple global contrast adjustment.
      </p>
    </div> -->
  </section>


  <!-- ============================================ 2.2 Hybrid Images ================================================ -->
  <section class="content gold-glass iteration-belt" id="part2-2">
    <h2 class="section-heading">2.2 Hybrid Images</h2>

    <div class="iteration-belt__intro">
      <p>
        A hybrid image combines the low frequencies of one photograph with the high frequencies of
        another so that perception changes with viewing distance. In this example, Derek’s face
        supplies the coarse, low-frequency structure, while Nutmeg contributes the fine,
        high-frequency detail such as fur and whiskers. The filtering parameters control how sharply
        these two bands are separated and how strongly the high-frequency content is reintroduced
        into the final composition.
      </p>
      <p>
        The portrait is heavily blurred with a Gaussian filter, producing a smooth low-pass image in
        which small-scale details are suppressed but the overall facial geometry and shading remain
        intact. The image of Nutmeg is transformed into a high-pass signal by subtracting a softened
        version of itself, yielding an essentially zero-mean edge map dominated by sharp contours
        and texture. Before the two components are added, the high-pass layer is attenuated so that
        cat features are clearly visible at close range but do not overwhelm the underlying
        low-frequency portrait when the hybrid is viewed from farther away.
      </p>
    </div>



    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Constructing a hybrid portrait–cat image</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>

    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/demo/A_stage1_aligned_cropped.png"
            alt="Aligned portrait used for low-pass component">
          <figcaption class="iteration-belt__caption">
            Aligned portrait (Derek): source for the low-frequency content of the hybrid. Only the
            global layout of the face and illumination are intended to survive the subsequent blur.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/demo/B_stage1_aligned_cropped.png"
            alt="Aligned cat image used for high-pass component">
          <figcaption class="iteration-belt__caption">
            Aligned cat (Nutmeg): source for high-frequency detail. Whiskers, fur strands, and sharp
            eye boundaries generate the high-pass structure that dominates close-up perception.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/demo/lowpass.png" alt="Low-pass filtered portrait">
          <figcaption class="iteration-belt__caption">
            Low-pass portrait with <code>ksize = 77, sigma = 13.5</code>: the wide Gaussian blur
            produces a very smooth image where fine texture is almost completely removed but the
            coarse arrangement of facial features remains clearly visible.
          </figcaption>
        </figure>


        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/demo/lowpass_fft.png"
            alt="Log-magnitude Fourier spectrum of low-pass portrait">
          <figcaption class="iteration-belt__caption">
            Low-pass Fourier magnitude: a bright blob concentrated at the center with horizontal and
            vertical streaks. This indicates that energy is almost entirely in low frequencies,
            matching the visually smooth low-pass portrait.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/demo/highpass.png"
            alt="High-pass filtered cat image">
          <figcaption class="iteration-belt__caption">
            High-pass cat with <code>ksize = 31, sigma = 5.0</code>: subtracting the blurred cat
            isolates edges and mid–high-frequency texture, yielding an almost embossed appearance
            with strong responses on whiskers and fur.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/demo/highpass_fft.png"
            alt="Log-magnitude Fourier spectrum of high-pass cat image">
          <figcaption class="iteration-belt__caption">
            High-pass Fourier magnitude: the central region is darkened, while energy appears in a
            ring and diagonal streaks further from the origin. These oriented bands correspond to
            Nutmeg’s whiskers and fur, confirming that low frequencies have been suppressed while
            edge-dominated components remain.
          </figcaption>
        </figure>



        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/demo/hybrid.png"
            alt="Hybrid image combining low-pass portrait and high-pass cat">
          <figcaption class="iteration-belt__caption">
            Hybrid image: adding <code>alpha · high</code> to the low-pass portrait yields a face
            that appears feline at close range but transitions to Derek’s portrait when the image is
            viewed from far away or at reduced resolution. The chosen <code>alpha = 0.2</code>
            balances visibility of Nutmeg’s detail with the stability of the large-scale portrait.
          </figcaption>
        </figure>



        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/demo/hybrid_fft.png"
            alt="Log-magnitude Fourier spectrum of hybrid image">
          <figcaption class="iteration-belt__caption">
            Hybrid Fourier magnitude: combines the bright central blob of the Derek low-pass
            spectrum with the outer high-frequency streaks from the cat. The spectrum literally
            appears as the sum of the previous two, mirroring how spatial low- and high-frequency
            content coexist in the hybrid.
          </figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The hybrid displays a clear dependence on viewing scale. At close range, the visual system
        preserves high spatial frequencies, and the edge layer therefore asserts itself through
        sharp textures and fine contours. As the image is reduced or viewed from a greater distance,
        these frequencies are progressively discarded, and the coarse structure of the underlying
        portrait becomes the principal object of perception. The Fourier plots render this shift in
        explicit form: the low-pass component gathers its energy near the spectral origin, the
        high-pass component disperses it into outer bands with marked directional organization, and
        the hybrid spectrum is nothing more than their superposition. The degree of blurring and the
        weight granted to the edge layer thus fix the partition of spatial scales between the two
        sources and determine which of them prevails in attention under different viewing
        conditions.
      </p>
    </div>
  </section>

  <!-- ============================================ 2.2.1 Hybrid Images ================================================ -->

  <section class="content gold-glass iteration-belt"  id="part2-2-extra">
    <h2 class="section-heading">2.2 Hybrid Images – Additional Examples</h2>

    <div class="writing-section">
      <p>
        These additional examples show how the same low– and high–frequency decomposition
        used for the above images appears in other engineering dispclines. In each case
        the original image is split into a smooth low-pass background, a high-pass detail
        layer, and their sum, the hybrid. Remote sensing and medical imaging routinely
        use this kind of separation to enhance structure without changing the overall
        brightness pattern of the data.
      </p>

      <!-- San Francisco hybrid ------------------------------------------------>
      <h3 class="iteration-belt__title">
        San Francisco Bay Area – low-pass background + high-pass urban detail
      </h3>


      <div class="static-panel static-panel--row" style="--static-panel-width: 64rem; --static-panel-image-max: 64rem;">
        <figure class="static-panel__item">
          <img class="static-panel__image" src="media/two/2_hybrid/sf/orig.png"
            alt="Original satellite image of the San Francisco Bay Area">
          <figcaption class="static-panel__caption">
            Original satellite image: a high-resolution panchromatic view of San Francisco,
            the Bay, and the surrounding terrain.
          </figcaption>
        </figure>

        <figure class="static-panel__item">
          <img class="static-panel__image" src="media/two/2_hybrid/sf/sf_low.png"
            alt="Low-pass version of the San Francisco satellite image">
          <figcaption class="static-panel__caption">
            Low-pass component: heavy Gaussian blurring suppresses block-by-block detail
            but preserves the large-scale shoreline, hills, and harbor geometry that matter
            at regional planning scales.
          </figcaption>
        </figure>

        <figure class="static-panel__item">
          <img class="static-panel__image" src="media/two/2_hybrid/sf/sf_highpass.png"
            alt="High-pass component of the San Francisco satellite image">
          <figcaption class="static-panel__caption">
            High-pass component: subtracting a blur isolates roads, piers, runways, and
            building edges as an almost zero-mean detail layer. Similar high-pass
            products are used in change detection and feature extraction pipelines.
          </figcaption>
        </figure>

        <figure class="static-panel__item">
          <img class="static-panel__image" src="media/two/2_hybrid/sf/sf_hybrid.png"
            alt="Hybrid San Francisco image combining low-pass and high-pass components">
          <figcaption class="static-panel__caption">
            Hybrid image: adding a scaled copy of the high-pass layer back to the low-pass
            background yields a map where coastlines and topography remain smooth, while
            man‑made structures stand out with enhanced contrast.
          </figcaption>
        </figure>
      </div>



      <!-- MRI hybrid ---------------------------------------------------------->
      <h3 class="iteration-belt__title">
        Brain MRI – low-pass anatomy + high-pass edge enhancement
      </h3>

      <div class="static-panel static-panel--row" style="--static-panel-width: 32rem; --static-panel-image-max: 84rem;">
        <figure class="static-panel__item">
          <img class="static-panel__image" src="media/two/2_hybrid/mri/orig.jpeg" alt="Original axial brain MRI slice">
          <figcaption class="static-panel__caption">
            Original MRI slice: a T1‑weighted axial brain image showing gray matter,
            white matter, and cerebrospinal fluid with modest scanner noise.
          </figcaption>
        </figure>

        <figure class="static-panel__item">
          <img class="static-panel__image" src="media/two/2_hybrid/mri/low.png" alt="Low-pass filtered brain MRI">
          <figcaption class="static-panel__caption">
            Low-pass component: Gaussian blurring removes fine cortical folds and grain
            while preserving overall brain shape and intensity falloff. This kind of
            smoothing is standard before segmentation or registration.
          </figcaption>
        </figure>

        <figure class="static-panel__item">
          <img class="static-panel__image" src="media/two/2_hybrid/mri/high.png" alt="High-pass component of brain MRI">
          <figcaption class="static-panel__caption">
            High-pass component: subtracting the blur produces an edge map that highlights
            tissue boundaries between gray matter, white matter, CSF, and skull. Similar
            high-frequency maps underlie many edge‑based MRI analysis methods.
          </figcaption>
        </figure>

        <figure class="static-panel__item">
          <img class="static-panel__image" src="media/two/2_hybrid/mri/hybrid.png"
            alt="Hybrid brain MRI combining low-pass anatomy and high-pass edges">
          <figcaption class="static-panel__caption">
            Hybrid MRI: the low-pass anatomy is combined with a scaled high-pass layer to
            sharpen sulci and ventricles while keeping intensities realistic. This mirrors
            unsharp masking and “edge‑enhanced” reconstructions used to make subtle
            structures easier to read.
          </figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Low-pass Jolie + high-pass Obama</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>

    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/obama/A_stage1_aligned_cropped.png"
            alt="Aligned Jolie image used for low-pass component">
          <figcaption class="iteration-belt__caption">
            Aligned Jolie (image A): source for the low-frequency structure of the hybrid.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/obama/B_stage1_aligned_cropped.png"
            alt="Aligned Obama image used for high-pass component">
          <figcaption class="iteration-belt__caption">
            Aligned Obama (image B): source for high-frequency detail in the hybrid.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/obama/lowpass.png"
            alt="Low-pass filtered Jolie image">
          <figcaption class="iteration-belt__caption">
            Low-pass Jolie with <code>low_ksize = 35</code>, <code>low_sigma = 9.5</code>.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/obama/lowpass_fft.png"
            alt="Log-magnitude Fourier spectrum of low-pass Jolie image">
          <figcaption class="iteration-belt__caption">
            Low-pass Fourier magnitude: energy concentrated near the origin.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/obama/highpass.png"
            alt="High-pass filtered Obama image">
          <figcaption class="iteration-belt__caption">
            High-pass Obama with <code>high_ksize = 71</code>, <code>high_sigma = 12.5</code>.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/obama/highpass_fft.png"
            alt="Log-magnitude Fourier spectrum of high-pass Obama image">
          <figcaption class="iteration-belt__caption">
            High-pass Fourier magnitude: suppressed center with energy in outer frequencies.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/obama/hybrid.png"
            alt="Hybrid image combining low-pass Jolie and high-pass Obama">
          <figcaption class="iteration-belt__caption">
            Hybrid image: low-pass Jolie + high-pass Obama.
          </figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/2_hybrid/obama/hybrid_fft.png"
            alt="Log-magnitude Fourier spectrum of the Jolie-Obama hybrid image">
          <figcaption class="iteration-belt__caption">
            Hybrid Fourier magnitude: superposition of low- and high-frequency bands.
          </figcaption>
        </figure>

      </div>
    </div>

    
  </section>



  <!-- ============================================ 2.3 Gaussian and Laplacian Stacks ================================ -->
  <section class="content gold-glass iteration-belt" style="--belt-item-width: 16rem; " id="part2-3">
    <h2 class="section-heading">2.3 Gaussian and Laplacian Stacks</h2>

    <div class="iteration-belt__intro">
      <p>
        A Gaussian stack is defined as a sequence of images <em>G<sub>0</sub>, …, G<sub>K</sub></em>
        generated by repeated convolution with the same Gaussian kernel. The base level
        <em>G<sub>0</sub></em> is the original image; each subsequent level
        <em>G<sub>k+1</sub></em> is obtained by smoothing <em>G<sub>k</sub></em>. Increasing the
        index <em>k</em> removes higher spatial frequencies and leaves progressively lower ones
        unchanged, so the stack organizes the image by scale.
      </p>
      <p>
        From this sequence one defines a Laplacian stack
        <em>L<sub>k</sub> = G<sub>k</sub> − G<sub>k+1</sub></em>. Each Laplacian level records the
        change incurred when passing from blur scale <em>k</em> to <em>k+1</em> and is therefore
        band-limited: it contains structure that is present at one scale but not at the next
        coarser scale. The original image satisfies the reconstruction identity
        <em>G<sub>0</sub> = G<sub>K</sub> + Σ<sub>k=0</sub><sup>K−1</sup> L<sub>k</sub></em>, so the
        decomposition is linear and lossless.
      </p>
    </div>

    <!-- Gaussian stacks: apple and orange -->
    <div class="static-panel static-panel--row" style="--static-panel-width: 32rem; --static-panel-image-max: auto;">
      <figure class="static-panel__item">
        <img class="static-panel__image" src="media/two/3_stacks/apple/gaussian_stack.png"
          alt="Gaussian stack for the apple">
        <figcaption class="static-panel__caption">
          Gaussian stack – apple.
        </figcaption>
      </figure>

      <figure class="static-panel__item">
        <img class="static-panel__image" src="media/two/3_stacks/orange/gaussian_stack.png"
          alt="Gaussian stack for the orange">
        <figcaption class="static-panel__caption">
          Gaussian stack – orange.
        </figcaption>
      </figure>
    </div>

    <p>
      In the Gaussian stacks for the apple and orange, small values of <em>k</em> preserve fine
      texture: sensor noise, skin blemishes, and pore structure are clearly visible. As
      <em>k</em> increases, these high-frequency components are attenuated and only slowly varying
      intensity patterns remain. The silhouette, the division between fruit and background, and a
      small number of broad highlight regions persist even in the deepest blur. The progression
      across levels is thus governed by a single principle: at each step, the admissible frequency
      band is restricted while spatial alignment of large-scale features is preserved.
    </p>

    <!-- Laplacian stacks: apple and orange -->
    <div class="static-panel static-panel--row" style="--static-panel-width: 32rem; --static-panel-image-max: auto;">
      <figure class="static-panel__item">
        <img class="static-panel__image" src="media/two/3_stacks/apple/laplacian_stack.png"
          alt="Laplacian stack for the apple">
        <figcaption class="static-panel__caption">
          Laplacian stack – apple.
        </figcaption>
      </figure>

      <figure class="static-panel__item">
        <img class="static-panel__image" src="media/two/3_stacks/orange/laplacian_stack.png"
          alt="Laplacian stack for the orange">
        <figcaption class="static-panel__caption">
          Laplacian stack – orange.
        </figcaption>
      </figure>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The Laplacian stacks express the same decomposition in differential form. Finest levels
        contain narrow ridges and speckle corresponding to pores, grain, and the sharpest edges;
        intermediate levels isolate the main fruit contour and the core of the specular highlight;
        coarsest levels contain only gentle transitions between fruit, table, and background. Each
        <em>L<sub>k</sub></em> is localized in scale: it vanishes at much finer and much coarser
        levels because its structures have either not yet been produced by smoothing or have
        already been averaged out.
      </p>
      <p>
        Together, the Gaussian and Laplacian stacks provide a complete account of how image
        information is distributed across scale. The Gaussian stack describes the state of the
        image after progressively discarding detail; the Laplacian stack specifies, level by level,
        which detail has been discarded. Later multiresolution procedures operate by manipulating or mixing selected
        Laplacian bands
        while leaving others fixed, thereby changing the allocation of structure across scales
        without violating the reconstruction identity.
      </p>
    </div>
  </section>


  <!-- ============================================ 2.4 Multiresolution Blend ======================================= -->
  <section class="content gold-glass iteration-belt" style="--belt-item-width: 16rem;" id="part2-4">
    <h2 class="section-heading">2.4 Multiresolution Blend</h2>

    <div class="viz-pair" style="--viz-pair-max: 64rem;" role="group"
      aria-label="Selected correspondences for homography estimation">
      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Image A</div>
        <img class="viz-pair__image" src="media/two/4_blend/oraple/apple.jpeg" alt="Image A Apple" loading="lazy">
      </figure>

      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Image B</div>
        <img class="viz-pair__image" src="media/two/4_blend/oraple/orange.jpeg" alt="Image B Orange " loading="lazy">
      </figure>
    </div>

    <div class="iteration-belt__intro">
      <p>
        Multiresolution blending constructs a composite image by combining the Laplacian stacks of
        two inputs under the control of a spatially varying mask. At each scale, the mask weights
        the contribution of the apple on one side and the orange on the other; a blurred version of
        the mask ensures that the transition between sources extends over a finite region rather
        than being confined to a single column of pixels. The blending is performed level-wise for
        all bands and for the coarsest Gaussian residual.
      </p>
    </div>

    <!-- Apple Laplacian (LA) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Apple Laplacian bands (LA)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LA_level_0.png" alt="LA level 0">
          <figcaption class="iteration-belt__caption">LA 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LA_level_1.png" alt="LA level 1">
          <figcaption class="iteration-belt__caption">LA 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LA_level_2.png" alt="LA level 2">
          <figcaption class="iteration-belt__caption">LA 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LA_level_3.png" alt="LA level 3">
          <figcaption class="iteration-belt__caption">LA 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LA_level_4.png" alt="LA level 4">
          <figcaption class="iteration-belt__caption">LA 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LA_level_5.png" alt="LA level 5">
          <figcaption class="iteration-belt__caption">LA 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="writing-section">
      <p>
        The LA stack contains band-pass detail from the apple. At fine levels, the bands isolate
        small-scale edges along the fruit boundary and subtle texture on the skin; at intermediate
        levels they capture the primary contour and highlight; at coarse levels they hold only
        slow transitions between the apple interior and the background. These bands will dominate
        the left half of the blend wherever the mask weight is close to one.
      </p>
    </div>


    <!-- Orange Laplacian (LB) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Orange Laplacian bands (LB)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LB_level_0.png" alt="LB level 0">
          <figcaption class="iteration-belt__caption">LB 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LB_level_1.png" alt="LB level 1">
          <figcaption class="iteration-belt__caption">LB 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LB_level_2.png" alt="LB level 2">
          <figcaption class="iteration-belt__caption">LB 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LB_level_3.png" alt="LB level 3">
          <figcaption class="iteration-belt__caption">LB 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LB_level_4.png" alt="LB level 4">
          <figcaption class="iteration-belt__caption">LB 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/LB_level_5.png" alt="LB level 5">
          <figcaption class="iteration-belt__caption">LB 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The LB stack plays the same role for the orange. Fine levels emphasize pore-like peel
        texture and sharp rim edges, mid levels encode the dominant contour and band of specular
        highlights, and coarse levels describe large-scale transitions between fruit, table, and
        background. In the final composite, these structures populate the right half of the image
        where the mask weights favor the orange.
      </p>
    </div>

    <!-- Blended bands (GA) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Blended bands (GA)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/GA_level_0.png" alt="GA level 0">
          <figcaption class="iteration-belt__caption">GA 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/GA_level_1.png" alt="GA level 1">
          <figcaption class="iteration-belt__caption">GA 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/GA_level_2.png" alt="GA level 2">
          <figcaption class="iteration-belt__caption">GA 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/GA_level_3.png" alt="GA level 3">
          <figcaption class="iteration-belt__caption">GA 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/GA_level_4.png" alt="GA level 4">
          <figcaption class="iteration-belt__caption">GA 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/GA_level_5.png" alt="GA level 5">
          <figcaption class="iteration-belt__caption">GA 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="writing-section">
      <p>
        The GA bands reveal the effect of the mask at each scale. At fine levels, the belt shows a
        crisp left–right split in high-frequency detail; at intermediate levels, the transition
        region broadens and mid-scale shape information is shared; at coarse levels, the shading of
        the apple side morphs gradually into the shading of the orange side. These bands sum, along
        with the coarsest Gaussian level, to reconstruct the oraple.
      </p>
    </div>

    <!-- Mask and mask levels (Ls) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Mask stack across scales</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/mask.png" alt="Binary vertical mask">
          <figcaption class="iteration-belt__caption">Hard mask.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/Ls_level_0.png" alt="Mask level 0">
          <figcaption class="iteration-belt__caption">Ls 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/Ls_level_1.png" alt="Mask level 1">
          <figcaption class="iteration-belt__caption">Ls 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/Ls_level_2.png" alt="Mask level 2">
          <figcaption class="iteration-belt__caption">Ls 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/Ls_level_3.png" alt="Mask level 3">
          <figcaption class="iteration-belt__caption">Ls 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/Ls_level_4.png" alt="Mask level 4">
          <figcaption class="iteration-belt__caption">Ls 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/oraple/Ls_level_5.png" alt="Mask level 5">
          <figcaption class="iteration-belt__caption">Ls 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The Ls stack shows how the hard left–right mask is progressively blurred with increasing
        level. At high resolution, the transition occurs over a narrow strip centered on the seam,
        so only a thin vertical band of high-frequency structure is mixed. At coarse levels, the
        weights vary over most of the fruits, ensuring that low-frequency shading and background
        tone change gradually rather than exhibiting a sharp step.
      </p>
    </div>

    <div class="viz-pair" style="--viz-pair-max: 64rem;" role="group"
      aria-label="Selected correspondences for homography estimation">
      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Apange?</div>
        <img class="viz-pair__image" src="media/two/4_blend/oraple/blend_result.png" alt="Image A Apple" loading="lazy">
        <figcaption class="static-panel__caption">
          Apple on the left, orange on the right.
        </figcaption>
      </figure>

      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Oraple</div>
        <img class="viz-pair__image" src="media/two/4_blend/oraple/blend_result_reverse.png" alt="Image B Orange "
          loading="lazy">
        <figcaption class="static-panel__caption">
          Orange on the left, apple on the right.
        </figcaption>
      </figure>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The band-wise visualizations show that the blending operation is distributed over the full
        range of spatial scales. High-frequency bands enforce continuity of edges and texture,
        intermediate bands control the handoff of medium-scale structure, and coarse bands align
        global illumination and background tone. The mask stack governs the spatial extent of
        mixing at each level, and the sum of all blended bands with the coarsest Gaussian level
        reconstructs a composite that respects the local structure of both inputs while suppressing
        the artifacts that would result from a hard cut between them.
      </p>
    </div>
  </section>

  <!-- ======================= 2.4 Multiresolution Blend – Jupiter and Infrared ======================= -->
  <section class="content gold-glass iteration-belt" id="part2-4-jupiter" style="--belt-item-width: 16rem;">
    <h2 class="section-heading">2.4 Multiresolution Blend – Jupiter and Infrared</h2>

    <div class="viz-pair" style="--viz-pair-max: 24rem;" role="group"
      aria-label="Selected correspondences for homography estimation">
      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Image A</div>
        <img class="viz-pair__image" src="media/two/4_blend/jupiter/jupiter.jpg" alt="Image B Charon " loading="lazy">
        <figcaption class="static-panel__caption">
          Jupiter Visible spectrum
        </figcaption>
      </figure>

      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Image B</div>
        <img class="viz-pair__image" src="media/two/4_blend/jupiter/jupiter_infrared.jpg" alt="Image A Moon"
          loading="lazy">
        <figcaption class="static-panel__caption">
          Jupiter Infarared
        </figcaption>
      </figure>
    </div>

    <div class="iteration-belt__intro">
      <p>
        This blend takes a visible-light image of Jupiter (image A) and an infrared composite
        (image B). Each is decomposed into a Gaussian stack and a corresponding Laplacian stack.
        A circular mask centred on the disc is likewise expanded into a stack, so that, at every
        scale, the weights vary smoothly from the infrared data in the interior to the visible
        image near the limb. The construction therefore fixes, level by level, how much of each
        modality contributes at each radius.
      </p>
    </div>


    <!-- Infrared Laplacian (LA) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Infrared Laplacian bands (LA)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LA_level_0.png" alt="LA level 0">
          <figcaption class="iteration-belt__caption">LA 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LA_level_1.png" alt="LA level 1">
          <figcaption class="iteration-belt__caption">LA 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LA_level_2.png" alt="LA level 2">
          <figcaption class="iteration-belt__caption">LA 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LA_level_3.png" alt="LA level 3">
          <figcaption class="iteration-belt__caption">LA 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LA_level_4.png" alt="LA level 4">
          <figcaption class="iteration-belt__caption">LA 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LA_level_5.png" alt="LA level 5">
          <figcaption class="iteration-belt__caption">LA 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The LA bands encode contrast from the infrared image B. Finest levels isolate compact
        bright structures and sharp boundaries within the storm belts; intermediate levels
        represent the broader banded emission; the coarsest level retains only slow variation of
        infrared brightness across the disc. Where the mask stack assigns high weight to the
        centre, these bands supply most of the high- and mid-frequency content of the blend.
      </p>
    </div>


    <!-- Visible Laplacian (LB) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Visible Laplacian bands (LB)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LB_level_0.png" alt="LB level 0">
          <figcaption class="iteration-belt__caption">LB 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LB_level_1.png" alt="LB level 1">
          <figcaption class="iteration-belt__caption">LB 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LB_level_2.png" alt="LB level 2">
          <figcaption class="iteration-belt__caption">LB 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LB_level_3.png" alt="LB level 3">
          <figcaption class="iteration-belt__caption">LB 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LB_level_4.png" alt="LB level 4">
          <figcaption class="iteration-belt__caption">LB 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/LB_level_5.png" alt="LB level 5">
          <figcaption class="iteration-belt__caption">LB 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The LB bands play the same role for the visible-light image A. Fine levels contain sharp
        edges around vortices and filaments, middle levels describe the familiar zonal bands and
        major storms, and coarse levels capture gradual changes in albedo and limb darkening.
        Towards the outer parts of the disc, where the mask favours the visible image, these
        bands dominate the reconstruction.
      </p>
    </div>


    <!-- Blended bands (GA) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Blended bands (GA)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/GA_level_0.png" alt="GA level 0">
          <figcaption class="iteration-belt__caption">GA 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/GA_level_1.png" alt="GA level 1">
          <figcaption class="iteration-belt__caption">GA 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/GA_level_2.png" alt="GA level 2">
          <figcaption class="iteration-belt__caption">GA 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/GA_level_3.png" alt="GA level 3">
          <figcaption class="iteration-belt__caption">GA 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/GA_level_4.png" alt="GA level 4">
          <figcaption class="iteration-belt__caption">GA 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/GA_level_5.png" alt="GA level 5">
          <figcaption class="iteration-belt__caption">GA 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The GA bands show the combined effect of the mask at each scale. At high frequencies,
        they already display infrared-bright structures embedded in visible cloud patterns; at
        intermediate scales the belts mix smoothly, and at the coarsest scales the overall
        brightening of the central region and the visible-dominated limb are both evident. Adding
        all GA levels together with the coarsest Gaussian residual reconstructs a single view in
        which the core follows the infrared measurement and the periphery follows the visible
        image, without introducing seams across radius or scale.
      </p>
    </div>


    <!-- Mask levels (Ls) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Mask stack across scales</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/mask.png" alt="Circular mask">
          <figcaption class="iteration-belt__caption">Hard mask.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/Ls_level_0.png" alt="Mask level 0">
          <figcaption class="iteration-belt__caption">Ls 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/Ls_level_1.png" alt="Mask level 1">
          <figcaption class="iteration-belt__caption">Ls 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/Ls_level_2.png" alt="Mask level 2">
          <figcaption class="iteration-belt__caption">Ls 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/Ls_level_3.png" alt="Mask level 3">
          <figcaption class="iteration-belt__caption">Ls 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/Ls_level_4.png" alt="Mask level 4">
          <figcaption class="iteration-belt__caption">Ls 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/jupiter/Ls_level_5.png" alt="Mask level 5">
          <figcaption class="iteration-belt__caption">Ls 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The Ls stack records how the circular mask is smoothed as the level index increases.
        Near the finest level, the weighting changes only across a narrow annulus, so mixing is
        confined to a thin band of fine-scale structure. At coarser levels the transition region
        occupies most of the disc, ensuring that low-frequency brightness and background tone
        change gradually from the infrared-dominated interior to the visible-dominated limb.
      </p>
    </div>

    <div class="viz-pair" style="--viz-pair-max: 64rem;" role="group"
      aria-label="Selected correspondences for homography estimation">
      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Final Blend</div>
        <img class="viz-pair__image" src="media/two/4_blend/jupiter/blend_result.png"
          alt="Multiresolution blend of visible and infrared Jupiter" loading="lazy">
        <figcaption class="static-panel__caption">
          Jupiter with visible cloud structure modulated by infrared emission in the
          central belts.
        </figcaption>
      </figure>

      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Reverse Blend</div>
        <img class="viz-pair__image" src="media/two/4_blend/jupiter/blend_result_reverse.png"
          alt="Multiresolution blend of visible and infrared Jupiter">
        <figcaption class="static-panel__caption">
          Visible bands in the core, infrared structure emphasized toward the limb.
        </figcaption>
    </div>
  </section>


  <!-- ======================= 2.4 Multiresolution Blend – Moon and Charon ======================= -->
  <section class="content gold-glass iteration-belt" style="--belt-item-width: 16rem;" id="part2-4-moon">
    <h2 class="section-heading">2.4 Multiresolution Blend – Moon and Charon</h2>

    <div class="viz-pair" style="--viz-pair-max: 64rem;" role="group"
      aria-label="Selected correspondences for homography estimation">
      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Image A</div>
        <img class="viz-pair__image" src="media/two/4_blend/moon/moon.jpg" alt="Image A Moon" loading="lazy">
        <figcaption class="static-panel__caption">
          Earth’s Moon
        </figcaption>
      </figure>

      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Imabe B</div>
        <img class="viz-pair__image" src="media/two/4_blend/moon/charon.jpg" alt="Image B Charon " loading="lazy">
        <figcaption class="static-panel__caption">
          Charon
        </figcaption>
      </figure>
    </div>


    <!-- Intro -->
    <div class="iteration-belt__intro">
      <p>
        The multiresolution blending pipeline is applied to Earth’s Moon and Pluto’s moon Charon.
        Each image is decomposed into Gaussian and Laplacian stacks, and a vertical mask is lifted
        to a stack so that, at each scale, the weights vary smoothly from the Charon side to the
        Moon side across the disc.
      </p>
    </div>


    <!-- Charon Laplacian (LA) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Charon Laplacian bands (LA)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LA_level_0.png" alt="LA level 0">
          <figcaption class="iteration-belt__caption">LA 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LA_level_1.png" alt="LA level 1">
          <figcaption class="iteration-belt__caption">LA 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LA_level_2.png" alt="LA level 2">
          <figcaption class="iteration-belt__caption">LA 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LA_level_3.png" alt="LA level 3">
          <figcaption class="iteration-belt__caption">LA 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LA_level_4.png" alt="LA level 4">
          <figcaption class="iteration-belt__caption">LA 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LA_level_5.png" alt="LA level 5">
          <figcaption class="iteration-belt__caption">LA 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="writing-section">
      <p>
        The LA bands contain Charon’s relief, from fine crater rims and ridges at the finest level
        to broad albedo and limb-darkening variations at coarser levels. These structures will
        occupy the left hemisphere of the final blend wherever the mask weight is close to one.
      </p>
    </div>

    <!-- Moon Laplacian (LB) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Moon Laplacian bands (LB)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LB_level_0.png" alt="LB level 0">
          <figcaption class="iteration-belt__caption">LB 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LB_level_1.png" alt="LB level 1">
          <figcaption class="iteration-belt__caption">LB 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LB_level_2.png" alt="LB level 2">
          <figcaption class="iteration-belt__caption">LB 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LB_level_3.png" alt="LB level 3">
          <figcaption class="iteration-belt__caption">LB 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LB_level_4.png" alt="LB level 4">
          <figcaption class="iteration-belt__caption">LB 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/LB_level_5.png" alt="LB level 5">
          <figcaption class="iteration-belt__caption">LB 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="writing-section">
      <p>
        The LB bands play the same role for Earth’s Moon on the right hemisphere. High levels carry
        its finest crater detail, lower levels carry mare–highland contrast and global illumination.
        Blending LA and LB under the mask at each scale yields a sphere with spatially consistent
        relief but different geology on each side.
      </p>
    </div>

    <!-- Blended bands (GA) -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Blended bands (GA)</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/GA_level_0.png" alt="GA level 0">
          <figcaption class="iteration-belt__caption">GA 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/GA_level_1.png" alt="GA level 1">
          <figcaption class="iteration-belt__caption">GA 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/GA_level_2.png" alt="GA level 2">
          <figcaption class="iteration-belt__caption">GA 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/GA_level_3.png" alt="GA level 3">
          <figcaption class="iteration-belt__caption">GA 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/GA_level_4.png" alt="GA level 4">
          <figcaption class="iteration-belt__caption">GA 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/GA_level_5.png" alt="GA level 5">
          <figcaption class="iteration-belt__caption">GA 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="writing-section">
      <p>
        The GA bands show the effect of masking at each scale: fine bands already display a clean
        left–right split in crater detail, and coarse bands show a smooth transition in shading and
        background tone. Their sum, together with the coarsest Gaussian level, reconstructs the
        final blended planet.
      </p>
    </div>

    <!-- Mask and mask levels -->
    <div class="iteration-belt__header">
      <h3 class="iteration-belt__title">Mask stack across scales</h3>
      <button type="button" class="iteration-belt__toggle" aria-pressed="false">Pause</button>
    </div>
    <div class="iteration-belt__viewport">
      <div class="iteration-belt__track">
        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/mask.png" alt="Binary vertical mask">
          <figcaption class="iteration-belt__caption">Hard mask.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/Ls_level_0.png" alt="Mask level 0">
          <figcaption class="iteration-belt__caption">Ls level 0.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/Ls_level_1.png" alt="Mask level 1">
          <figcaption class="iteration-belt__caption">Ls level 1.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/Ls_level_2.png" alt="Mask level 2">
          <figcaption class="iteration-belt__caption">Ls level 2.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/Ls_level_3.png" alt="Mask level 3">
          <figcaption class="iteration-belt__caption">Ls level 3.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/Ls_level_4.png" alt="Mask level 4">
          <figcaption class="iteration-belt__caption">Ls level 4.</figcaption>
        </figure>

        <figure class="iteration-belt__item">
          <img class="iteration-belt__image" src="media/two/4_blend/moon/Ls_level_5.png" alt="Mask level 5">
          <figcaption class="iteration-belt__caption">Ls level 5.</figcaption>
        </figure>
      </div>
    </div>

    <div class="iteration-belt__outro">
      <p>
        The hard mask is progressively blurred as the level increases, so the transition band
        widens at coarser scales. High-frequency bands therefore change sources over a narrow band
        near the meridian, while low-frequency shading and background brightness change over a much
        broader region.
      </p>
    </div>

    <div class="viz-pair" style="--viz-pair-max: 54rem; --viz-pair-gap: 1rem;">
      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Final Blend</div>
        <img class="viz-pair__image" src="media/two/4_blend/moon/blend_result.png">
        <div class="iteration-belt__caption">
          Left: Charon Right: Earth’s Moon
        </div>
      </figure>

      <figure class="viz-pair__panel">
        <div class="viz-pair__title">Reverse Blend</div>
        <img class="viz-pair__image" src="media/two/4_blend/moon/blend_result_reverse.png">
        <div class="iteration-belt__caption">
          Left: Earth’s Moon Right: Charon
        </div>
      </figure>
    </div>


  </section>


  <script src="../script.js"></script>
</body>

</html>